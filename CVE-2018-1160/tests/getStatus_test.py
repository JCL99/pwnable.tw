import socket
import struct
import sys

ip = "chall.pwnable.tw"
port = 10002

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

print "[+] Attempting connection to " + ip + ":" + str(port)
sock.connect((ip, port))

dsi_header = "\x00" # "request" flag
dsi_header += "\x03" # open session command
dsi_header += "\x00\x01" # request id
dsi_header += "\x00\x00\x00\x00" # data offset
dsi_header += struct.pack(">I", 0)
dsi_header += "\x00\x00\x00\x00" # reserved

sock.sendall(dsi_header)
resp = sock.recv(1024)
print "[+] Open Session complete"

print resp
